# Prometheus Grafana Entegrasyonu (Prometheus Öğreniyoruz 9)

Merhaba arkadaşlar

Prometheus öğreniyoruz yazı serisinin son makalesinde Grafana ile Prometheus'u birbiriyle konuşturmaya çalışacağız.

Grafana ile ilgili bağımsız bir bir makale serisi hazırlamayı düşünüyorum ancak şimdilik Prometheus metriklerini Grafana üzerinde takip edecek kadar öğrenmeye çalışalım.

Grafana eksiksiz bir [observability](https://en.wikiversity.org/wiki/Software_Design/Observability) (gözlemlenebilirlik) çözümüdür. Grafana ile uygulama ve sistemlerimizi monitör edebilir, meteriklerini ve loglarını analiz edebiliriz. Verilerimizi görselleştirebilir ve alert'ler üretebiliriz. Neredeyse bütün veri kaynaklarından veri çekebilmektedir.

Tam bir çözüm olarak aslında Grafana birden fazla ürünü içinde barındırır. Prometheus ile çok sıkı ilişkisi vardır ve doğal entegrasyon desteği de vardır.

- **Loki**: Loglama mekanizmasıdır. Sadece basit anlamda log tutmanın ötesinde indeksleme, metadata atama gibi işlemleri de yapar.Ayrıca object storage'larda veri tutma gibi özellikleri de vardır.
![simple-scalable-test-environment.png](files/simple-scalable-test-environment.png)
- **Tempo**: Yüksek hacimli tracing verilerini object storage kullanarak agent yardımıyla toplayıp Grafana'ya sunar.
![tempo_getting-started.png](files/tempo_getting-started.png)
- **Mimir**: Prometheus  için yüksek performanslı, high available, multitanent bir storage çözümüdür.  

Konumuz Grafana'ya veri kaynağı olarak Prometheus'u göstermek olduğu için bu yazımızda bahsi geçen araçlarla ilgilenmeyeceğiz.

## Grafana Kurulum ve Entegrasyon

Grafana'yı hemen hemen bütün işletim sistemlerine kurabilirsiniz. Resmi download sayfasından istediğiniz yöntemle kurulumu yapabilirsiniz. Gerekli tüm bilgiler sayfasında verildiği için detyaylara girmeyeceğim. Kendim Docker versiyonunu kullancağım ancak siz istediğiniz işletim sistemini ve yöntemi tercih edebilirsiniz.

Resmi olarak Docker için sadece Linux versiyonu var.Alttaki komutla çalıştırabilirsiniz. Tabii ki Windows için de resmi olmayan image bulabilirsiniz. 

```
docker run --restart unless-stopped -d -p 3000:3000 grafana/grafana-oss:8.5.2-ubuntu

```
Daha sonra tarayıcıda _http://localhost:3000_ adresini çağıracak olursak sistem bize kullanıcı adı ve şifre soracak ardından değiştirmemizi isteyecektir. Kullanıcı adı ve şifre alanlarına _admin_ yazıp giriş yapabiliriz.

Prometheus'u data source olarka eklemek için alttaki gibi _Data Sources_ menüsünden _Add data source_ butonuna tıklıyoruz.

![grafana.png](files/grafana.png)

Ardından açılacak sayfada Prometheus'u seçiyoruz. URL kısmına _http://localhost:9090_ gerekli kalan bütün ayarları default değerleriyle bırakabiliriz. 

**UYARI**: Eğer Grafana Docker üzerinde çalıştıyorsanız haliyle localhost dediğinizde sistem Grafana konteyneri üzerinde arayacaktır bu nedenle Docker kullananlar URL kısmına Prometheus'un ip adresini yazmalıdır. Eğer Prometheus host makinanızda çalışıyorsa onun IP adresini, eğer Prometheus da Docker üzerinde çalışıyorsa onun IP adresini yazmalılar.  

_Save & Test_ butonuna tıklayıp hata yoksa Dashboards tabına tıklayıp listedeki üç dashboard'u da import ediyoruz. 

![grafana.png](files/grafana.png)

Daha sonra dashboards menüsünden browse'a tıklayıp ardından _Prometheus 2.0 Stats'a_ tıklıyoruz. 

![grafana3.png](files/grafana3.png)

Açılan sayfada bizzat Prometheus'un kendisi ile ilgili metrikleri içeren dashboard'u görüyor olacağız. Dashboard aslında farklı eri kaynaklarını kullanarak oluşturulan görsellerin bulunduğu monitör sayfasıdır. Grafana kurulduğunda zaten import ettiğimiz dashboard'lar default olarak gelmiş oldu. Marketinde daha yüzlercesini bulmak mümkün. Ayrıca biz de kendimiz ihtiyaçlarımıza göre custom dashboard'lar oluşturabiliriz.

Ekrandaki bileşenlerden herhangi birini edit'leyecek olursak Prometheus query'lerini görebiliriz.

![grafana4.png](files/grafana4.png)

![grafana5.png](files/grafana5.png)

## Grafana Dashboard Oluşturmak








Yazının diğer makaleleri için alttaki linkleri kullanabilirsiniz.
- [Prometheus'a Giriş](1.prometheus-nedir.md)
- [Prometheus Instrumentation ve Node Exporter Kullanımı](2.instrumentation.md)
- [PromQL Kullanımı](3.quering.md)
- [Prometheus Kural Tanımlama](4.configuring_rules.md)
- [Prometheus Alertmanager Kullanımı](5.alertmanager.md)
- [Prometheus Blackbox Exporter Kullanımı](6.blackbox_exporter.md)
- [Prometheus Pushgateway Exporter Kullanımı](7.pushgateway.md)
- [Prometheus Service Discovery](8.service_discovery.md)
- [Prometheus Grafana Entegrasyonu](9.grafana_integration.md)